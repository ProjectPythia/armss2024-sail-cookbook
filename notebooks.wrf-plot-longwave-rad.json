{"version":2,"kind":"Notebook","sha256":"e74ee84a3445fa99c93fc427b96e048495e2b3db44136ed2e991733029bae5ec","slug":"notebooks.wrf-plot-longwave-rad","location":"/notebooks/wrf_plot_longwave_rad.ipynb","dependencies":[],"frontmatter":{"title":"Plot downward longwave (LW) radiation at surface for WRF Simulations","content_includes_title":false,"kernelspec":{"name":"conda-base-py","display_name":"Python [conda env:base] *","language":"python"},"authors":[{"nameParsed":{"literal":"Project Pythia Community","given":"Project Pythia","family":"Community"},"name":"Project Pythia Community","url":"https://projectpythia.org/","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true},"code":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/projectpythia/armss2024-sail-cookbook","copyright":"2024","affiliations":[{"id":"University at Albany (State University of New York)","name":"University at Albany (State University of New York)"},{"id":"UCAR/NCAR","name":"UCAR/NCAR"}],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/armss2024-sail-cookbook/blob/main/notebooks/wrf_plot_longwave_rad.ipynb","exports":[{"format":"ipynb","filename":"wrf_plot_longwave_rad.ipynb","url":"/armss2024-sail-cookbook/build/wrf_plot_longwave_ra-9751e2a7eef28e2d16d11deb934557e0.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"WRF simulations serve as comparison to observations. Here the downward longwave radiation for the high black carbon loading event is considered. The results from the high dust event was difficult to interpret and is omitted.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"AKrodgSieJ"}],"key":"EhDjjkYbIa"}],"key":"uDBcegWSlU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import xarray as xr\nimport cartopy\nimport matplotlib\nimport matplotlib.pyplot as plt\nfrom matplotlib.gridspec import GridSpec\n%matplotlib inline","key":"xJNi1WxNhk"},{"type":"output","id":"pjQNKbwB32tQGab6q0SgS","data":[{"name":"stderr","output_type":"stream","text":"ERROR 1: PROJ: proj_create_from_database: Open of /opt/conda/share/proj failed\n"}],"key":"BGF1NRZuSC"}],"key":"u5hMVwfGCz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Plot downward LW radiation at surface\n# January 26th had no clouds so this day serves as comparison \ndataset_25 = xr.open_mfdataset('wrf_data/jan_2022/wrfhourly_d03_2022-01-25.nc')\ndataset_26 = xr.open_mfdataset('wrf_data/jan_2022/wrfhourly_d03_2022-01-26.nc')\ndataset_02 = xr.open_mfdataset('wrf_data/jan_2022/wrfhourly_d03_2022-01-02.nc')\nmean_dataset_diff = dataset_25.mean(dim=\"Time\") - dataset_02.mean(dim=\"Time\")\n\nfig = plt.figure(figsize = (12,3),constrained_layout=True)\n\ngs = GridSpec(1, 3, figure=fig)\nax1 = fig.add_subplot(gs[0, 0])\ndataset_25.mean(dim=\"Time\").GLW.plot(x='south_north',y='west_east',cbar_kwargs={'label': r\"Downward LW at Surf.\"})\nax1.set_title('Jan 25, 2022')\nax2 = fig.add_subplot(gs[0, 1])\ndataset_26.mean(dim=\"Time\").GLW.plot(x='south_north',y='west_east',cbar_kwargs={'label': r\"Downward LW at Surf.\"})\nax2.set_title('Jan 26, 2022')\nax3 = fig.add_subplot(gs[0, 2])\nmean_dataset_diff.GLW.plot(x='south_north',y='west_east',cbar_kwargs={'label': r\"Downward LW at Surf.\"})\nax3.set_title('Jan 25th - Control')","key":"ion0oqPUdJ"},{"type":"output","id":"byNVER0qhBcSKKO9Blrfn","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e6bd8ac02690ddb3fef2d8eea7621379","path":"/armss2024-sail-cookbook/build/e6bd8ac02690ddb3fef2d8eea7621379.png"},"text/plain":{"content":"<Figure size 1200x300 with 6 Axes>","content_type":"text/plain"}}}],"key":"hGAWE48xss"}],"key":"gudVIVnYrI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# plot time series of downward LW radiation for Jan 25 \ndataset_25 = xr.open_mfdataset('wrf_data/jan_2022/wrfhourly_d03_2022-01-25.nc')\ntime_series = dataset_25.mean(dim=\"south_north\")\ntime_series = time_series.mean(dim=\"west_east\")\nfig = plt.figure(figsize = (12,4),constrained_layout=True)\ntime_series.GLW.plot()\nplt.grid()\nplt.title('time series of LWR')\nplt.ylabel('Downward LWR at surface / W$m^{-2}$')","key":"U7jWJcFqd5"},{"type":"output","id":"HQBqAxVct73BWOqEU5a_s","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6cdaa41b9595169ad0e24c7cbb0935cc","path":"/armss2024-sail-cookbook/build/6cdaa41b9595169ad0e24c7cbb0935cc.png"},"text/plain":{"content":"<Figure size 1200x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"qwpmw5rhgS"}],"key":"McjwopliGW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# plot time series of downward LW radiation for Jan 26\ndataset_26 = xr.open_mfdataset('wrf_data/jan_2022/wrfhourly_d03_2022-01-26.nc')\ntime_series = dataset_26.mean(dim=\"south_north\")\ntime_series = time_series.mean(dim=\"west_east\")\nfig = plt.figure(figsize = (12,4),constrained_layout=True)\ntime_series.GLW.plot()\nplt.grid()\nplt.title('time series of LWR')\nplt.ylabel('Downward LWR at surface / W$m^{-2}$')","key":"xnUKqnpxV5"},{"type":"output","id":"uwVeZE2kkH1HvjpLYJixX","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"38d4c3cce6a6d2649b63ead4a2e38fd3","path":"/armss2024-sail-cookbook/build/38d4c3cce6a6d2649b63ead4a2e38fd3.png"},"text/plain":{"content":"<Figure size 1200x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"GN3OCj8WYJ"}],"key":"Z1F6SELdiY"}],"key":"BzI5mX7uHh"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"SP2 Plots For SAIL events","url":"/notebooks/ajcssailnotebook","group":"Evaluating black carbon & dust concentrations"},"next":{"title":"Longwave IR Radiation Ratios","url":"/radiometer","group":"Longwave radiation variations"}}},"domain":"http://localhost:3000"}